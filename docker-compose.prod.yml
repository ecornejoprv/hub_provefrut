version: '3.8'

services:
  # --- BACKEND (Django API) ---
  backend:
    container_name: hub_backend_prod
    build: 
      context: .
      dockerfile: Dockerfile
    restart: always
    env_file:
      - .env  
    networks:
      - hub_net

  # --- FRONTEND (React + Nginx) ---
  frontend:
    container_name: hub_frontend_prod
    build: 
      context: ./portal_webd
      dockerfile: Dockerfile
      # Pasamos las variables para que React sepa a d√≥nde apuntar los botones
      args:
        - VITE_URL_COMPRAS=${VITE_URL_COMPRAS}
        - VITE_URL_CHATBOT=${VITE_URL_CHATBOT}
    restart: always
    ports:
      - "9000:80" # Mapea el puerto 80 del contenedor al puerto 9000 del host
    depends_on:
      - backend
    env_file:
      - ./portal_web/.env # Lee las URLs de los otros sistemas
    networks:
      - hub_net

networks:
  hub_net:
    driver: bridge